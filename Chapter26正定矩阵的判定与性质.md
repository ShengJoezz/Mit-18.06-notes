---
author: joe
rating: 8
content: 本章对正定矩阵的判定与性质进行了详细说明，尤其是二阶矩阵的特性。
coverage: p28
tags:
  - math
  - linear_algebra
  - class
time: 2023-09-08
---
我们在[[Chapter24实对称矩阵与正定矩阵]]中简要介绍了正定矩阵的定义与性质，正定矩阵有一些好处：在矩阵数值计算中，正定矩阵消元不需要进行“行交换”操作，也不必担心主元过小或为零，正定矩阵具有良好的计算性质。这一章我们做一些更详细的陈述。
![[Chapter24实对称矩阵与正定矩阵#^35c749|正定矩阵的引入]]

# Section1.正定矩阵的判定方法

我们仍然从二阶说起，有矩阵$A=\begin{bmatrix}a&b\\b&d\end{bmatrix}$，判断其正定性有以下方法：

1. 矩阵的所有特征值大于零则矩阵正定：$\lambda_1>0,\ \lambda_2>0$；
2. 矩阵的所有顺序主子阵（leading principal submatrix）的行列式（即顺序主子式，leading principal minor）大于零则矩阵正定：$a>0,\ ac-b^2>0$；
3. 矩阵消元后主元均大于零：$a>0,\ \frac{ac-b^2}{a}>0$；
4. $x^TAx>0$；

大多数情况下使用4来定义正定性，而用前三条来验证正定性。

```ad-note
title: 正定矩阵的一个充要条件
我们可以认为$x^TAx=f(x_1,x_2,\cdots,x_n)=(x_1+tx_k)^2+....$，对这个有两种说法:
1.当$x≠0$时,$f(x_1,x_2,\cdots,x_n)>0$
2.$f(x_1,x_2,\cdots,x_n)\geq0$,等号有且仅在$x=0$的时候取到

那么提醒我们对于正定矩阵的判定可以通过先考虑$f是否\geq0$，接着判断$=$成立时$x$的情况。
```

# Section2.正定矩阵的实例与讨论

我们考虑$A=\begin{bmatrix}2&6\\6&?\end{bmatrix}$，在$?$处填入多少才能使矩阵正定？

## 情形1.$?=18$的时候(临界状态)

此时矩阵为$A=\begin{bmatrix}2&6\\6&18\end{bmatrix}$，$\det A=0$，此时的矩阵处于一个临界状态，我们称之为半正定矩阵，矩阵奇异。

性质1的检验：其中一个特征值必为$0$，从迹得知另一个特征值为$20$。
性质2的检验：可知二阶的顺序行列式为0
性质3的检验：主元为2和0
性质4的检验：$\begin{bmatrix}x_1&x_2\end{bmatrix}\begin{bmatrix}2&6\\6&18\end{bmatrix}\begin{bmatrix}x_1\\x_2\end{bmatrix}=2x_1^2+12x_1x_2+18x_2^2=2(x_1+3x_2)^2$

## 情形2.$?=7$的时候(非正定状态)

令$?=7$，矩阵为$A=\begin{bmatrix}2&6\\6&7\end{bmatrix}$

性质1的检验：其中一个特征值必小于0，因为行列式的值小于0，而迹大于0
性质2的检验：可知二阶的顺序行列式为$-22$
性质3的检验：主元为2和$-11$
性质4的检验：$\begin{bmatrix}x_1&x_2\end{bmatrix}\begin{bmatrix}2&6\\6&7\end{bmatrix}\begin{bmatrix}x_1\\x_2\end{bmatrix}=f(x_1,x_2)=2x_1^2+12x_1x_2+7x_2^2=2(x_1+3x_2)^2-11x_2^2$，可知$f(x_1,x_2)$显然不是恒大于0的，让$x_1+3x_2=0$即可，就不恒大于0了。

### 几何角度:

 如果我们把$z=2x^2+12xy+7y^2$放在直角坐标系中，图像过原点$z(0,0)=0$，当$y=0$或$x=0$或$x=y$时函数为开口向上的抛物线，所以函数图像在某些方向上是正值；而在某些方向上是负值，比如$x=-y$，所以函数图像是一个马鞍面（saddle），$(0,0,0)$点称为鞍点（saddle point），它在某些方向上是极大值点，而在另一些方向上是极小值点。（实际上函数图像的最佳观测方向是沿着特征向量的方向。）

![[马鞍面示例.png|400]]

![[马鞍面示例1.png|400]]

### 代数角度

实际上就是考虑$(0,0)$是不是这个多元函数的最小值或者极小值。

$$\begin{aligned}f(x,y)=2x^2+&12xy+7y^2\\\frac{\partial f}{\partial x}=4x+12y=0\ &\frac{\partial f}{\partial y}=12x+14y=0\\\frac{\partial f^2}{\partial^2 x}=4\ \frac{\partial f^2}{\partial^2 y}&=14\frac{\partial f^2}{\partial xy}=12\\AC-B^2&=-88<0\\可知此时(0,0)一阶导数&为0的点，但不是极值点\end{aligned}$$
因此，这个矩阵不是正定矩阵。

## Subsection3.$?=20$的时候(正定状态)

令$?=20$，矩阵为$A=\begin{bmatrix}2&6\\6&20\end{bmatrix}$

性质1的检验：行列式为$\det A=4$，迹为$trace(A)=22$，特征值均大于0
性质2的检验：可知二阶的行列式为$\det A=4$，一阶显然也＞0.
性质3的检验：主元为2和$2$
性质4的检验：$f(x_1,x_2)=2x_1^2+12x_1x_2+20x_2^2=2(x_1+3x_2)^2+2x_2^2>0$.

### 几何角度

该函数的图像为抛物面（paraboloid）。在$(0,0)$点函数的一阶偏导数均为零，二阶偏导数均为正（马鞍面的一阶偏导数也为零，但二阶偏导数并不均为正，所以），函数在该点可以取到极小值。

![[抛物面的示例1.png|400]]


![[抛物面的示例.png|400]]

### 代数角度

$$\begin{aligned}f(x,y)=2x^2+&12xy+20y^2\\\frac{\partial f}{\partial x}=4x+12y=0\ &\frac{\partial f}{\partial y}=12x+40y=0\\\frac{\partial f^2}{\partial^2 x}=4\ \frac{\partial f^2}{\partial^2 y}&=40\frac{\partial f^2}{\partial xy}=12\\AC-B^2=16&>0且A>0\\可知此时(0,0)一阶导数&为0的点，但不是极值点\end{aligned}$$

# Section3.总结

对于上述的几个情形，尤其我们考虑非正定矩阵与正定矩阵的判断，我们用了三种方式，一种是配方，二种是几何角度，三种是代数角度。

## 配方法:

代数角度里，考虑了极小值的情况:

在本例中（即二阶情形），如果能用平方和的形式来表示函数，则很容易看出函数是否恒为正，$f(x,y)=2x^2+12xy+20y^2=2\left(x+3y\right)^2+2y^2$。另外，如果是上面的$?=7$的情形，则有$f(x,y)=2(x+3y)^2-11y^2$，如果是$?=18$的情形，则有$f(x,y)=2(x+3y)^2$。

再来看这个矩阵的消元，$\begin{bmatrix}1&0\\-3&1\end{bmatrix}\begin{bmatrix}2&6\\6&20\end{bmatrix}=\begin{bmatrix}2&6\\0&2\end{bmatrix}$，化为$A=LU$为$\begin{bmatrix}2&6\\6&20\end{bmatrix}=\begin{bmatrix}1&0\\3&1\end{bmatrix}\begin{bmatrix}2&6\\0&2\end{bmatrix}$，可以发现:

1. 矩阵$L$中的项与配平方中未知数的系数有关
2. 主元与平方项的系数有关

这也就是为什么正数主元可以得到正定矩阵。

## 几何角度

如果令$z=1$(是有手法的，就相当于单位矩阵$I$)，相当于使用$z=1$平面截取该函数图像，在$?=20$将得到一个椭圆曲线。另外，如果在$?=7$的马鞍面上截取曲线将得到一对双曲线。

## 代数角度

在微积分中，一元函数取极小值需要一阶导数为零且二阶导数为正$\frac{\mathrm{d}u}{\mathrm{d}x}=0, \frac{\mathrm{d}^2u}{\mathrm{d}x^2}>0$。在线性代数中我们遇到了了多元函数$f(x_1,x_2,\cdots,x_n)$，要取==极小值需要二阶偏导数矩阵为正定矩阵==。

这个矩阵型为$\begin{bmatrix}f_{xx}&f_{xy}\\f_{yx}&f_{yy}\end{bmatrix}$，显然，矩阵中的主对角线元素（纯二阶导数）必须为正，并且主对角线元素必须足够大来抵消混合导数的影响。同时还可以看出，因为二阶导数的求导次序并不影响结果，所以矩阵必定对称。

# Section4.高阶的矩阵

接下来计算一个三阶矩阵，$A=\begin{bmatrix}2&-1&0\\-1&2&-1\\0&-1&2\end{bmatrix}$，它是正定的吗？函数$x^TAx$是多少？函数在原点取得到最小值吗？图像是什么样的？

* 先来计算矩阵的顺序主子式，分别为$2,3,4$；再来计算主元，分别为$2,\frac{3}{2},\frac{4}{3}$；计算特征值，$\lambda_1=2-\sqrt 2,\lambda_2=2,\lambda_3=2+\sqrt 2$。
* 计算$x^TAx=2x_1^2+2x_2^2+2x_3^2-2x_1x_2-2x_2x_3$。
* 图像是四维的抛物面，当我们在$f(x_1,x_2,x_3)=1$处截取该面，将得到一个椭圆体。一般椭圆体有三条轴，特征值的大小决定了三条轴的长度，而特征向量的方向与三条轴的方向相同。

现在我们将矩阵$A$分解为$A=Q\Lambda Q^T$，可以发现上面说到的各种元素都可以表示在这个分解的矩阵中，我们称之为主轴定理（principal axis theorem），即特征向量说明主轴的方向、特征值说明主轴的长度。

$A=Q\Lambda Q^T$是特征值相关章节中最重要的公式。

# Section5.正定矩阵的一些性质

1. 正定矩阵的逆也是正定矩阵。
	证明:
	$$\begin{aligned}AA^{-1}=I\stackrel{取转置}{\rightarrow}({A^{-1}})^TA^T=I&\stackrel{A=A^T}{\rightarrow}({A^{-1}})^TA=I\rightarrow ({A^{-1}})^T=A^{-1}\\&因此A^{-1}是对称矩阵\\&\lambda_{A^{-1}}=\frac{1}{\lambda_{A}}>0\\&故A^{-1}是正定矩阵\end{aligned}$$
2. 正定矩阵的和仍为正定矩阵
   证明:
   $$\begin{aligned}x^TAx>0,\ x^TBx>0\therefore x^T(A+B)x>0\end{aligned}$$
3. 若$A$列满秩，则$A^TA$正定
   证明：
   $$\begin{aligned}对称&性易证\\x^TA^TAx=(Ax)&^T(Ax)=|Ax|^2\geq0\\如果要让Ax只有当x=0的时候&为0向量，则A零空间只能有零向量\\因此A只能&列满秩\end{aligned}$$